{
  "content": "\n# Build your own static web server with Deno\n\nOne of things I have in my web toolbox is a static site web server. It only runs on localhost. It amazes me how often I wind up using it. PHP and Python can launch one easily from the command line but I have always found they were lacking. What I want is a simple web server that runs only on localhost. It can serve content from a specified directory and should handle common content types appropriately (e.g. JavaScript files are served as \"application/javascript\" not as \"text/plain\"). I should be able choose the port the server runs on. I should be able to specify a document root for the content I want to expose. It should default to a sensible location like the \"htdocs\" directory in my current working directory.\n\nWhen I started working with the web (when people used the NCSA web server), web servers were considered complex and hard to implement. I remember most network systems were presumed complex. Today most programming languages have some sort of library, module or package that makes implementing a web server trivial. This is true for JavaScript running under a JavaScript run time engine.\n\nDeno is a JavaScript and TypeScript runtime. I prefer Deno over other JavaScript runtimes like NodeJS. Deno runs sandboxed. This is similar to how the web browser treats JavaScript. Deno's standard library aligns with web browser implementation too. Deno has a good set of standard modules. Many modules can also be used browser side. \n\nI'll be using some Deno standard JavaScript modules in this post. The standard module \"@std/http/file-server\" provides most of what you need to implement a static content server. Two other modules will round things out in how I want my web server to behave. They are \"@std/fs/exists\" and \"@std/yaml/parse\".\n\nLet's build a simple but useful static web server and add it to our web toolbox.\n\nBefore I build my static web server I need some web content. I'm going to need an HTML file and a JavaScript file. This will provide content to test. The web content should be created in a directory called \"htdocs\". On macOS, Linux and Windows the command I run from in the terminal application to create the \"htdocs\" directory is `mkdir htdocs`. Using your my editor, I created the HTML file called \"helloworld.html\" inside the \"htdocs\" directory.\n\n~~~html\n<!DOCTYPE html>\n<head>\n  <script type=\"module\" src=\"helloworld.js\"></script>\n</head>\n<html lang=\"en-US\">\n  <body>Hello World</body>\n</html>\n~~~\n\nI created a \"helloworld.js\" inside the \"htdocs\" directory too.\n\n~~~JavaScript\nconst body = document.querySelector(\"body\");\nconst elem = document.createElement(\"div\");\nelem.innerText = 'Hello World 2!';\nbody.append(elem);\n~~~\n\nThis provides content to test my prototypes. Using these files I can make sure the prototype properly serves out a web page, handles a file listing and properly services the JavaScript.\n\nYour directory tree should look something like this.\n\n~~~shell\ntree htdocs\nhtdocs/\n├── helloworld.html\n└── helloworld.js\n\n1 directory, 2 files\n~~~\n\n## First prototype\n\nUsing a text editor, I create a file called `webserver_v1.js`. I need to do several things in JavaScript to build our static web server.\n\n1. import a function called `serveDir` from the \"@std/http/file-server\" module\n2. I need to set two constants, a port number and a root document path\n3. It is helpful to display the setting for the port and document root when the server starts up\n4. I can using Deno's built in `serve` method to handle inbound requests and then dispatch them to `serveDir`\n\nLet's start with the import, `\"@std/http/file-server`.  Notice that it starts with and \"@\". This indicates to the JavaScript runtime that the full URL to the module is defined by an import map. When you build a Deno project you can generate a file called `deno.json`. It can include an import map. The `deno add` command provides a really easy way to manage this mapping. As of Deno 2 the standard modules are available from [jsr.io](https://jsr.io), a reliable JavaScript registry. This includes our standard module `@std/http/file-server`. I can \"add\" it  to my project using the following command.\n\n~~~shell\ndeno add jsr:@std/http/file-server\n~~~\n\nIf the \"deno.json\" file does not exist this command will create it. If it does exist Deno will update it to reflect the new module. I can look inside the \"deno.json\" file after running this command and see my import map.\n\n~~~json\n{\n  \"imports\": {\n    \"@std/http\": \"jsr:@std/http@^1.0.18\"\n  }\n}\n~~~\n\nThe Deno runtime knows how to contact jsr.io and use it to retrieve the module requested.  By default it picks the current stable version. In my case that is v1.0.18. Deno updates happen pretty steadily through out the year. When I try this a month from now it'll probably be a different version number.\n\nNow that Deno is setup, I need to write my first prototype static web server.\n\n~~~JavaScript\n/**\n * webserver_v1.js - A simple static file server for serving files from the \"htdocs\" directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst port = 8000;\nconst rootPath = \"htdocs\"; // Serve files from the \"htdocs\" directory\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});\n~~~\n \nThe `Deno.serve` manages the inbound request and the async anonymous function handles the mapping to the file server module function called `serveDir`. A try catch wraps the `serveDir` function. If that function fails a 404 response is created and returned. Pretty simple.\n\nLet's see if the code we typed in works. Deno provides three helpful commands for working with your program code \n\n1. check \n2. lint\n3. fmt\n\nCheck reads the JavaScript (or TypeScript) file and makes sure it makes sense from the compilation point of view.  The lint command goes a step further. It checks to see if best practices have been followed. Lint is completely optional but check needs to pass before Deno will attempt to run or compile the program. The `fmt` command will format your source code in a standard way. I'm going to use check and lint.\n\n~~~shell\ndeno check webserver_v1.js\ndeno lint webserver_v1.js\n~~~\n\nAll went well. In both cases I see a line indicating it checked the file. If I had made errors check and lint would have complained and included lines describing errors.\n\nDeno can run our JavaScript and TypeScript files. To test my program I try the following. \n\n~~~shell\ndeno run webserver_v1.js\n~~~\n\nWhen I tried this I saw the following message. \n\n~~~shell\nServer running on http://localhost:8000/, serving htdocs\n┏ ⚠️  Deno requests net access to \"0.0.0.0:8000\".\n┠─ Requested by `Deno.listen()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-net\n┠─ Run again with --allow-net to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all net permissions) > \n~~~\n\nI type \"y\" and press enter. New lines appear.\n\n~~~shell\nServer running on http://localhost:8000/, serving htdocs\n✅ Granted net access to \"0.0.0.0:8000\".\nListening on http://0.0.0.0:8000/ (http://localhost:8000/)\n~~~\n\nI point my web browser to \"http://localhost:8000/\". Do I see anything? No. In my terminal window I see another prompt about permissions.\n\n~~~shell\n┏ ⚠️  Deno requests read access to \"htdocs\".\n┠─ Requested by `Deno.stat()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-read\n┠─ Run again with --allow-read to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all read permissions)\n~~~\n\nAgain answer \"y\". I then see something this in my terminal window.\n\n~~~shell\n[2025-06-30 16:27:31] [GET] / 200\nNo such file or directory (os error 2): stat '/Users/rsdoiel/Sandbox/Writing/Books/A_Simple_Web/htdocs/favicon.ico'\n[2025-06-30 16:27:31] [GET] /favicon.ico 404\n~~~\n\nI reload my web browser page, what do I see? A list of files. I know that file directory listing works.\nOne of the files is \"helloworld.html\".  I click on it. I my simple web page with the words \"Hello World\" and \"Hello World 2\". Yippee, I've created a static web server.\n\nYou might be wondering how I shutdown the web server. In the terminal window I press control and the letter c, aka \"Ctrl-C\". This will shuts down the web server. I can confirm it is shutdown in the web browser by reloading the page. I see an connection error page now.\n\nI don't want to answer questions about permissions each time I run my prototype. I can specify the permissions I want to grant on the command line.  I know from my test that my program needs \"net\" and \"read\" permissions. I can grant this using the following command.\n\n~~~shell\ndeno run --allow-net --allow-read webserver_v1.js\n~~~\n\nBetter yet I can compile our JavaScript program into an executable file. An executable is handy because I can run it without Deno being installed on a different computer as long as it runs the same operating system and has the same CPU type. Compiling to an executable makes this prototype similar to our tools in my web tool box. It let's me treat it just like my terminal application, text editor and web browser.\n\n~~~shell\ndeno compile --allow-net --allow-read webserver_v1.js\n~~~\n\nThis results in a file being created called \"webserver_v1\" (or on Windows, \"webserver_v1.exe\"). This file can be run from this directory or moved to another directory where I store other programs (e.g. `$HOME/bin` or `$HOME\\bin` on Windows).\n\n## Improving on v1\n\nWhile webserver_v1.js is helpful it could be more friendly. What if I want to use a different port number? What if I want to server out content my current directory or maybe I want to service content on a different mounted drive? I can do that by adding support for command line arguments.\n\n~~~JavaScript\n/**\n * webserver_v2.js - A simple static file server with configurable port and root directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\n// Check the command arguments and set the port and rootPath appropriately\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});\n~~~\n\nI can compile that using the following deno compile command\n\n~~~shell\ndeno compile --allow-net --allow-read webserver_v2.js\n~~~\n\nWe can run the new webserver using the following command.\n\n~~~shell\n./webserver_v2 8001 .\n~~~\n\nPoint the web browser at <http://localhost:8001>. What do I see the directory? Yep, I see the files in my root directory of my project including the \"htdocs\" directory I created. Can I find and display \"helloworld.html\"? Yep and it works as in the first prototype. I shutdown the web server and then start it again using just the executable name.\n\nmacOS and Linux\n\n~~~shell\n./webserver_v2\n~~~\n\non Windows\n\n~~~shell\n.\\webserver_v2\n~~~\n\nWhat do you see? Can you find \"helloworld.html\"? Stop the web server. I copy \"helloworld.html\" to \"index.html\". After copying I restart the web server again.\n\nOn macOS and Linux\n\n~~~shell\ncp htdocs/helloworld.html htdocs/index.html\n./webserver_v2\n~~~\n\nOn Windows\n\n~~~pwsh\ncopy htdocs\\helloworld.html htdocs\\index.html\n.\\webserver_v2\n~~~\n\nI point the web browser at <http://localhost:8000>, what do I see? I don't see the file directory any more, I see the contents of  I copied into the \"index.html\" file, \"Hello World\" and \"Hello World 2\".\n\nCan this be improved?  It'd be nice to web able to just type \"webserver_v2\" and have the program using a default port and htdocs directory of my choice. That can be supported by using a configuration file. YAML is an easy to read and easy to type notation. It even supports comments which is nice in configuration files. YAML expresses the same types of data structures as JSON (JavaScript Object Notation). Below an example of a configuration file. I type it in and save it using the filename \"webserver.yaml\".\n\n~~~yaml\n# Set root path for web content to the current directory.\nhtdocs: .\n# Set the port number to listen on to 8002\nport: 8002\n~~~\n\nFrom the point of the view of my prototype it'll need to check if the \"webserver.yaml\" file exists before attempting to read it. Deno has a module for that. It'll also need to read the YAML, parse it and get an object that exposes my preferred settings. Deno has a standard model for working with YAML too. The modules I'm interested in are `@std/fs/exists` and `@std/yaml`. I'll need to \"add\" them to my deno project.\n\n~~~shell\ndeno add jsr:@std/fs/exists\ndeno add jsr:@std/yaml\n~~~\n\nTime for an improved version of the static web server. This prototype should be called, \"webserver_v3.js\".\n\n~~~JavaScript\n/**\n * webserver_v3.js - A simple static file server with configurable port and root directory via YAML.\n */\nimport { serveDir } from \"@std/http/file-server\";\nimport { parse } from \"@std/yaml/parse\";\nimport { exists } from \"@std/fs/exists\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Function to read and parse YAML configuration file\nasync function readConfigFile(filePath) {\n  try {\n    const fileContent = await Deno.readTextFile(filePath);\n    return parse(fileContent);\n  } catch (err) {\n    console.error(\"Error reading or parsing YAML file:\", err);\n    return null;\n  }\n}\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n} else {\n  // Check for YAML configuration file\n  const configFilePath = \"webserver.yaml\";\n  if (await exists(configFilePath)) {\n    const config = await readConfigFile(configFilePath);\n    if (config) {\n      rootPath = config.htdocs || defaultRoot;\n      port = config.port || defaultPort;\n    }\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});\n~~~\n\nLike before I compile it with the my desired permissions.\n\n~~~shell\ndeno compile --allow-net --allow-read webserver_v3.js\n./webserver_v3\n~~~\n\nI point the web browser at <http://localhost:8002>. What do I see? I see the contents of the index.html file. Can I display \"helloworld.html\" too? Yep. I remove the \"index.html\" file, then use my browser back button to go to the initial URL, yep I see a file directory listing again. Looks like this prototype works.\n\nI think I have a useful localhost static content web server. It's time to rename my working prototype, compile and install it so it is available in my toolbox.\n\n1. Copy `webserver_v3.js` to `webserver.js` \n2. Use `deno compile` to create an executable\n3. Create a \"$HOME/bin\" directory if necessary\n4. Move the executable to a location in the executable PATH with, example \"$HOME/bin\"\n5. Try running the program\n\nNOTE: If you are following along and have to create \"$HOME/bin\" then you may need to added to your environment's PATH.\n\nOn macOS and Linux\n\n~~~shell\ncp webserver_v3.js webserver.js\ndeno compile --allow-net --allow-read webserver.js\nmkdir -p $HOME/bin\nmv ./webserver $HOME/bin\nwebserver\n~~~\n\nOn Windows\n\n~~~shell\ncopy webserver_v3.js webserver.js\ndeno install --global --allow-net --allow-read webserver.js\nNew-Item -ItemType Directory -Path \"$HOME\\bin\" -Force\nmove webserver.exe $HOME\\bin\\\nwebserver\n~~~\n\nThere you have it. I have a new convenient static web server for serving static content on localhost.\n\n",
  "content_ast": {
    "children": [
      {
        "children": [
          {
            "type": "text",
            "value": "Build your own static web server with Deno"
          }
        ],
        "depth": 1,
        "type": "heading"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "One of things I have in my web toolbox is a static site web server. It only runs on localhost. It amazes me how often I wind up using it. PHP and Python can launch one easily from the command line but I have always found they were lacking. What I want is a simple web server that runs only on localhost. It can serve content from a specified directory and should handle common content types appropriately (e.g. JavaScript files are served as \"application/javascript\" not as \"text/plain\"). I should be able choose the port the server runs on. I should be able to specify a document root for the content I want to expose. It should default to a sensible location like the \"htdocs\" directory in my current working directory."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "When I started working with the web (when people used the NCSA web server), web servers were considered complex and hard to implement. I remember most network systems were presumed complex. Today most programming languages have some sort of library, module or package that makes implementing a web server trivial. This is true for JavaScript running under a JavaScript run time engine."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Deno is a JavaScript and TypeScript runtime. I prefer Deno over other JavaScript runtimes like NodeJS. Deno runs sandboxed. This is similar to how the web browser treats JavaScript. Deno's standard library aligns with web browser implementation too. Deno has a good set of standard modules. Many modules can also be used browser side."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I'll be using some Deno standard JavaScript modules in this post. The standard module \"@std/http/file-server\" provides most of what you need to implement a static content server. Two other modules will round things out in how I want my web server to behave. They are \"@std/fs/exists\" and \"@std/yaml/parse\"."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Let's build a simple but useful static web server and add it to our web toolbox."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Before I build my static web server I need some web content. I'm going to need an HTML file and a JavaScript file. This will provide content to test. The web content should be created in a directory called \"htdocs\". On macOS, Linux and Windows the command I run from in the terminal application to create the \"htdocs\" directory is "
          },
          {
            "type": "inlineCode",
            "value": "mkdir htdocs"
          },
          {
            "type": "text",
            "value": ". Using your my editor, I created the HTML file called \"helloworld.html\" inside the \"htdocs\" directory."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "html",
        "type": "code",
        "value": "<!DOCTYPE html>\n<head>\n  <script type=\"module\" src=\"helloworld.js\"></script>\n</head>\n<html lang=\"en-US\">\n  <body>Hello World</body>\n</html>"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I created a \"helloworld.js\" inside the \"htdocs\" directory too."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "const body = document.querySelector(\"body\");\nconst elem = document.createElement(\"div\");\nelem.innerText = 'Hello World 2!';\nbody.append(elem);"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "This provides content to test my prototypes. Using these files I can make sure the prototype properly serves out a web page, handles a file listing and properly services the JavaScript."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Your directory tree should look something like this."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "tree htdocs\nhtdocs/\n├── helloworld.html\n└── helloworld.js\n\n1 directory, 2 files"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "First prototype"
          }
        ],
        "depth": 2,
        "type": "heading"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Using a text editor, I create a file called "
          },
          {
            "type": "inlineCode",
            "value": "webserver_v1.js"
          },
          {
            "type": "text",
            "value": ". I need to do several things in JavaScript to build our static web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "import a function called "
                  },
                  {
                    "type": "inlineCode",
                    "value": "serveDir"
                  },
                  {
                    "type": "text",
                    "value": " from the \"@std/http/file-server\" module"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "I need to set two constants, a port number and a root document path"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "It is helpful to display the setting for the port and document root when the server starts up"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "I can using Deno's built in "
                  },
                  {
                    "type": "inlineCode",
                    "value": "serve"
                  },
                  {
                    "type": "text",
                    "value": " method to handle inbound requests and then dispatch them to "
                  },
                  {
                    "type": "inlineCode",
                    "value": "serveDir"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          }
        ],
        "ordered": true,
        "spread": false,
        "start": 1,
        "type": "list"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Let's start with the import, "
          },
          {
            "type": "inlineCode",
            "value": "\"@std/http/file-server"
          },
          {
            "type": "text",
            "value": ".  Notice that it starts with and \"@\". This indicates to the JavaScript runtime that the full URL to the module is defined by an import map. When you build a Deno project you can generate a file called "
          },
          {
            "type": "inlineCode",
            "value": "deno.json"
          },
          {
            "type": "text",
            "value": ". It can include an import map. The "
          },
          {
            "type": "inlineCode",
            "value": "deno add"
          },
          {
            "type": "text",
            "value": " command provides a really easy way to manage this mapping. As of Deno 2 the standard modules are available from "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "jsr.io"
              }
            ],
            "type": "link",
            "url": "https://jsr.io"
          },
          {
            "type": "text",
            "value": ", a reliable JavaScript registry. This includes our standard module "
          },
          {
            "type": "inlineCode",
            "value": "@std/http/file-server"
          },
          {
            "type": "text",
            "value": ". I can \"add\" it  to my project using the following command."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno add jsr:@std/http/file-server"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "If the \"deno.json\" file does not exist this command will create it. If it does exist Deno will update it to reflect the new module. I can look inside the \"deno.json\" file after running this command and see my import map."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "json",
        "type": "code",
        "value": "{\n  \"imports\": {\n    \"@std/http\": \"jsr:@std/http@^1.0.18\"\n  }\n}"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "The Deno runtime knows how to contact jsr.io and use it to retrieve the module requested.  By default it picks the current stable version. In my case that is v1.0.18. Deno updates happen pretty steadily through out the year. When I try this a month from now it'll probably be a different version number."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Now that Deno is setup, I need to write my first prototype static web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "/**\n * webserver_v1.js - A simple static file server for serving files from the \"htdocs\" directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst port = 8000;\nconst rootPath = \"htdocs\"; // Serve files from the \"htdocs\" directory\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "The "
          },
          {
            "type": "inlineCode",
            "value": "Deno.serve"
          },
          {
            "type": "text",
            "value": " manages the inbound request and the async anonymous function handles the mapping to the file server module function called "
          },
          {
            "type": "inlineCode",
            "value": "serveDir"
          },
          {
            "type": "text",
            "value": ". A try catch wraps the "
          },
          {
            "type": "inlineCode",
            "value": "serveDir"
          },
          {
            "type": "text",
            "value": " function. If that function fails a 404 response is created and returned. Pretty simple."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Let's see if the code we typed in works. Deno provides three helpful commands for working with your program code"
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "check"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "lint"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "fmt"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          }
        ],
        "ordered": true,
        "spread": false,
        "start": 1,
        "type": "list"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Check reads the JavaScript (or TypeScript) file and makes sure it makes sense from the compilation point of view.  The lint command goes a step further. It checks to see if best practices have been followed. Lint is completely optional but check needs to pass before Deno will attempt to run or compile the program. The "
          },
          {
            "type": "inlineCode",
            "value": "fmt"
          },
          {
            "type": "text",
            "value": " command will format your source code in a standard way. I'm going to use check and lint."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno check webserver_v1.js\ndeno lint webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "All went well. In both cases I see a line indicating it checked the file. If I had made errors check and lint would have complained and included lines describing errors."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Deno can run our JavaScript and TypeScript files. To test my program I try the following."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno run webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "When I tried this I saw the following message."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "Server running on http://localhost:8000/, serving htdocs\n┏ ⚠️  Deno requests net access to \"0.0.0.0:8000\".\n┠─ Requested by `Deno.listen()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-net\n┠─ Run again with --allow-net to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all net permissions) > "
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I type \"y\" and press enter. New lines appear."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "Server running on http://localhost:8000/, serving htdocs\n✅ Granted net access to \"0.0.0.0:8000\".\nListening on http://0.0.0.0:8000/ (http://localhost:8000/)"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I point my web browser to \"http://localhost:8000/\". Do I see anything? No. In my terminal window I see another prompt about permissions."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "┏ ⚠️  Deno requests read access to \"htdocs\".\n┠─ Requested by `Deno.stat()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-read\n┠─ Run again with --allow-read to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all read permissions)"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Again answer \"y\". I then see something this in my terminal window."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "[2025-06-30 16:27:31] [GET] / 200\nNo such file or directory (os error 2): stat '/Users/rsdoiel/Sandbox/Writing/Books/A_Simple_Web/htdocs/favicon.ico'\n[2025-06-30 16:27:31] [GET] /favicon.ico 404"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I reload my web browser page, what do I see? A list of files. I know that file directory listing works.\nOne of the files is \"helloworld.html\".  I click on it. I my simple web page with the words \"Hello World\" and \"Hello World 2\". Yippee, I've created a static web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "You might be wondering how I shutdown the web server. In the terminal window I press control and the letter c, aka \"Ctrl-C\". This will shuts down the web server. I can confirm it is shutdown in the web browser by reloading the page. I see an connection error page now."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I don't want to answer questions about permissions each time I run my prototype. I can specify the permissions I want to grant on the command line.  I know from my test that my program needs \"net\" and \"read\" permissions. I can grant this using the following command."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno run --allow-net --allow-read webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Better yet I can compile our JavaScript program into an executable file. An executable is handy because I can run it without Deno being installed on a different computer as long as it runs the same operating system and has the same CPU type. Compiling to an executable makes this prototype similar to our tools in my web tool box. It let's me treat it just like my terminal application, text editor and web browser."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno compile --allow-net --allow-read webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "This results in a file being created called \"webserver_v1\" (or on Windows, \"webserver_v1.exe\"). This file can be run from this directory or moved to another directory where I store other programs (e.g. "
          },
          {
            "type": "inlineCode",
            "value": "$HOME/bin"
          },
          {
            "type": "text",
            "value": " or "
          },
          {
            "type": "inlineCode",
            "value": "$HOME\\bin"
          },
          {
            "type": "text",
            "value": " on Windows)."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Improving on v1"
          }
        ],
        "depth": 2,
        "type": "heading"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "While webserver_v1.js is helpful it could be more friendly. What if I want to use a different port number? What if I want to server out content my current directory or maybe I want to service content on a different mounted drive? I can do that by adding support for command line arguments."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "/**\n * webserver_v2.js - A simple static file server with configurable port and root directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\n// Check the command arguments and set the port and rootPath appropriately\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I can compile that using the following deno compile command"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno compile --allow-net --allow-read webserver_v2.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "We can run the new webserver using the following command."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "./webserver_v2 8001 ."
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Point the web browser at "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "http://localhost:8001"
              }
            ],
            "type": "link",
            "url": "http://localhost:8001"
          },
          {
            "type": "text",
            "value": ". What do I see the directory? Yep, I see the files in my root directory of my project including the \"htdocs\" directory I created. Can I find and display \"helloworld.html\"? Yep and it works as in the first prototype. I shutdown the web server and then start it again using just the executable name."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "macOS and Linux"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "./webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "on Windows"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": ".\\webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "What do you see? Can you find \"helloworld.html\"? Stop the web server. I copy \"helloworld.html\" to \"index.html\". After copying I restart the web server again."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On macOS and Linux"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "cp htdocs/helloworld.html htdocs/index.html\n./webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On Windows"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "pwsh",
        "type": "code",
        "value": "copy htdocs\\helloworld.html htdocs\\index.html\n.\\webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I point the web browser at "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "http://localhost:8000"
              }
            ],
            "type": "link",
            "url": "http://localhost:8000"
          },
          {
            "type": "text",
            "value": ", what do I see? I don't see the file directory any more, I see the contents of  I copied into the \"index.html\" file, \"Hello World\" and \"Hello World 2\"."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Can this be improved?  It'd be nice to web able to just type \"webserver_v2\" and have the program using a default port and htdocs directory of my choice. That can be supported by using a configuration file. YAML is an easy to read and easy to type notation. It even supports comments which is nice in configuration files. YAML expresses the same types of data structures as JSON (JavaScript Object Notation). Below an example of a configuration file. I type it in and save it using the filename \"webserver.yaml\"."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "yaml",
        "type": "code",
        "value": "# Set root path for web content to the current directory.\nhtdocs: .\n# Set the port number to listen on to 8002\nport: 8002"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "From the point of the view of my prototype it'll need to check if the \"webserver.yaml\" file exists before attempting to read it. Deno has a module for that. It'll also need to read the YAML, parse it and get an object that exposes my preferred settings. Deno has a standard model for working with YAML too. The modules I'm interested in are "
          },
          {
            "type": "inlineCode",
            "value": "@std/fs/exists"
          },
          {
            "type": "text",
            "value": " and "
          },
          {
            "type": "inlineCode",
            "value": "@std/yaml"
          },
          {
            "type": "text",
            "value": ". I'll need to \"add\" them to my deno project."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno add jsr:@std/fs/exists\ndeno add jsr:@std/yaml"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Time for an improved version of the static web server. This prototype should be called, \"webserver_v3.js\"."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "/**\n * webserver_v3.js - A simple static file server with configurable port and root directory via YAML.\n */\nimport { serveDir } from \"@std/http/file-server\";\nimport { parse } from \"@std/yaml/parse\";\nimport { exists } from \"@std/fs/exists\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Function to read and parse YAML configuration file\nasync function readConfigFile(filePath) {\n  try {\n    const fileContent = await Deno.readTextFile(filePath);\n    return parse(fileContent);\n  } catch (err) {\n    console.error(\"Error reading or parsing YAML file:\", err);\n    return null;\n  }\n}\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n} else {\n  // Check for YAML configuration file\n  const configFilePath = \"webserver.yaml\";\n  if (await exists(configFilePath)) {\n    const config = await readConfigFile(configFilePath);\n    if (config) {\n      rootPath = config.htdocs || defaultRoot;\n      port = config.port || defaultPort;\n    }\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Like before I compile it with the my desired permissions."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno compile --allow-net --allow-read webserver_v3.js\n./webserver_v3"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I point the web browser at "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "http://localhost:8002"
              }
            ],
            "type": "link",
            "url": "http://localhost:8002"
          },
          {
            "type": "text",
            "value": ". What do I see? I see the contents of the index.html file. Can I display \"helloworld.html\" too? Yep. I remove the \"index.html\" file, then use my browser back button to go to the initial URL, yep I see a file directory listing again. Looks like this prototype works."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I think I have a useful localhost static content web server. It's time to rename my working prototype, compile and install it so it is available in my toolbox."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Copy "
                  },
                  {
                    "type": "inlineCode",
                    "value": "webserver_v3.js"
                  },
                  {
                    "type": "text",
                    "value": " to "
                  },
                  {
                    "type": "inlineCode",
                    "value": "webserver.js"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Use "
                  },
                  {
                    "type": "inlineCode",
                    "value": "deno compile"
                  },
                  {
                    "type": "text",
                    "value": " to create an executable"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Create a \"$HOME/bin\" directory if necessary"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Move the executable to a location in the executable PATH with, example \"$HOME/bin\""
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Try running the program"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          }
        ],
        "ordered": true,
        "spread": false,
        "start": 1,
        "type": "list"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "NOTE: If you are following along and have to create \"$HOME/bin\" then you may need to added to your environment's PATH."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On macOS and Linux"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "cp webserver_v3.js webserver.js\ndeno compile --allow-net --allow-read webserver.js\nmkdir -p $HOME/bin\nmv ./webserver $HOME/bin\nwebserver"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On Windows"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "copy webserver_v3.js webserver.js\ndeno install --global --allow-net --allow-read webserver.js\nNew-Item -ItemType Directory -Path \"$HOME\\bin\" -Force\nmove webserver.exe $HOME\\bin\\\nwebserver"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "There you have it. I have a new convenient static web server for serving static content on localhost."
          }
        ],
        "type": "paragraph"
      }
    ],
    "type": "root"
  },
  "data": {
    "abstract": "This post discusses static web server implementation using Deno.\n",
    "author": "R. S. Doiel",
    "byline": "R. S. Doiel",
    "copyright": "copyright (c) 2025, R. S. Doiel",
    "dateCreated": "2025-06-30",
    "dateModified": "2025-07-01",
    "keywords": [
      "web service",
      "static web site",
      "JavaScript"
    ],
    "license": "https://creativecommons.org/licenses/by-sa/4.0/",
    "number": 8,
    "pubDate": "2025-06-30",
    "series": "Deno and TypeScript",
    "title": "Build a Static Web Server with Deno"
  }
}