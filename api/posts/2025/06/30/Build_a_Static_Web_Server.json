{
  "content": "\n# Build your own static web server with Deno\n\nOne of things I have in my web toolbox is a static site web server. It only runs on localhost. It amazes me how often I wind up using it. PHP and Python can launch one easily from the command line but I have always found they were lacking. What I want is a simple web server that runs only on localhost. It can serve content from a specified directory and should handle common content types appropriately (e.g. JavaScript files are served as \"application/javascript\" not as \"text/plain\"). I should be able choose the port the server runs on. I should be able to specify a document root for the content I want to expose. It should default to a sensible location like the \"htdocs\" directory in my current working directory.\n\nDeno is a JavaScript and TypeScript runtime. I prefer Deno for several reasons over other runtimes like NodeJS. First Deno runs sandboxed similar to the web browser. Deno's standard library follows browser where there is overlap between running on your machien versus the browser. Deno good set  of standard modules. This includes \"@std/http/file-server\" which I'll use to create a static site web server. Other modules I'll be using are \"@std/fs/exists\" and \"@std/yaml/parse\". Normally when I write for Deno I write TypeScript but for this article I'm going to use plain old JavaScript.\n\nLet's build a simple but useful static web server for our web toolbox.\n\nBefore we build our static web server some web content, an HTML file. Create a directory \"htdocs\" directory. On macOS, Linux and Windows the command we want to run in the terminal is `mkdir htdocs`. Using your text editor, create the HTML file called \"helloworld.html\" inside the \"htdocs\" directory.\n\n~~~html\n<!DOCTYPE html>\n<head>\n  <script type=\"module\" src=\"helloworld.js\"></script>\n</head>\n<html lang=\"en-US\">\n  <body>Hello World</body>\n</html>\n~~~\n\nNow let's create a \"helloworld.js\" inside the \"htdocs\" directory too.\n\n~~~JavaScript\nconst body = document.querySelector(\"body\");\nconst elem = document.createElement(\"div\");\nelem.innerText = 'Hello World 2!';\nbody.append(elem);\n~~~\n\nThis will give us some content to test with.\n\nYour directory tree shoud look something like this.\n\n~~~shell\ntree htdocs\nhtdocs/\n├── helloworld.html\n└── helloworld.js\n\n1 directory, 2 files\n~~~\n\nI'll use these two files to for tesitng the web server.\n\n## First take\n\nUsing a text editor, create a file called `webserver_v1.js`. We need to do several things in JavaScript to build our static web server.\n\n1. import a function called `serveDir` from the \"@std/http/file-server\" module\n2. We need to set two constants, our port number and root document path\n3. It is helpful to display the setting for the port and document root\n4. We can using Deno's built in `serve` method to handle inbound requests and then dispatch them to `serveDir`\n\nLet's start with our import, `\"@std/http/file-server`.  Notice that it starts with and \"@\". This indicates to the JavaScript runtime that the full URL to the module is found in a import map. When you build a Deno project you can use a file called `deno.json` to include a mapping of module names. The `deno` command provides a really easy way to manage this mapping. As of Deno 2 the standard modules are available from [jsr.io](https://jsr.io), a JavaScript registry. The module `@std/http/file-server` is part of the standard module package called `@std/http`. We can \"add\" that to our project using the following command\n\n~~~shell\ndeno add jsr:@std/http\n~~~\n\nIf the \"deno.json\" file does not exist this command will create it. If you look inside it after running this command you'll see something like this.\n\n~~~json\n{\n  \"imports\": {\n    \"@std/http\": \"jsr:@std/http@^1.0.18\"\n  }\n}\n~~~\n\nThe Deno run time knows how to contact jsr.io and use it to etrieve the module requested.  By default it picks the current stable version. In our case that is currently v1.0.18. If you are reading this is in the distant the future is the version number will likely have changed. Deno updates have come pretty steadly in 2025.\n\nNow that that Deno is setup, I need to write our first version of a static web server.\n\n~~~JavaScript\n/**\n * webserver_v1.js - A simple static file server for serving files from the \"htdocs\" directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst port = 8000;\nconst rootPath = \"htdocs\"; // Serve files from the \"htdocs\" directory\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});\n~~~\n\nLet's see if the code we typed in works. Deno provide two helpful commands. \n\n1. check \n2. lint\n\nCheck read the JavaScript (or TypeScript) file and makes server it makes sense from the compilation point of view.  The lint command goes a step further. It checks to see if best practices have been followed. Lint is completely optional but check needs to pass before Deno will attempt to run our program.\n\n~~~shell\ndeno check webserver_v1.js\ndeno lint webserver_v1.js\n~~~\n\nIf all went well in both cases you should see a line indicating it checked the file. If there are complaints you'll see those too.\n\nDeno can run in interactive mode. To test our program we'll initially run it. \n\n~~~shell\ndeno run webserver_v1.js\n~~~\n\nYou should a message like the one below. This is because Deno wants permission to access the network.\n\n~~~shell\nServer running on http://localhost:8000/, serving htdocs\n┏ ⚠️  Deno requests net access to \"0.0.0.0:8000\".\n┠─ Requested by `Deno.listen()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-net\n┠─ Run again with --allow-net to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all net permissions) > \n~~~\n\nFor can type an \"y\" for now. Now you should see a lines like those below.\n\n~~~shell\nServer running on http://localhost:8000/, serving htdocs\n✅ Granted net access to \"0.0.0.0:8000\".\nListening on http://0.0.0.0:8000/ (http://localhost:8000/)\n~~~\n\nPoint your web browser to \"http://localhost:8000/\". Do you see anything?  In your terminal window you'll see another prompt about permissions.\n\n~~~shell\n┏ ⚠️  Deno requests read access to \"htdocs\".\n┠─ Requested by `Deno.stat()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-read\n┠─ Run again with --allow-read to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all read permissions)\n~~~\n\nAgain answer \"y\". You then see something like this in the terminal window.\n\n~~~shell\n[2025-06-30 16:27:31] [GET] / 200\nNo such file or directory (os error 2): stat '/Users/rsdoiel/Sandbox/Writing/Books/A_Simple_Web/htdocs/favicon.ico'\n[2025-06-30 16:27:31] [GET] /favicon.ico 404\n~~~\n\nWhat do you do you see in the browser page?  Is it a list of files? Is one of them \"helloworld.html\"?  If so click on it. You should now see an simple web page with the words \"Hello World\". Congratulations, you've created your first static web server.\n\nYou might be wondering how to shutdown the web server. In the terminal window press control and the letter c, aka \"Ctrl-C\". This will shutdown the web server. You can confirm it is shutdown in the web browser by reloading the page.\n\nYou don't need to answer questions about permissions each time you run a program. You can specify the permissions you want to grant on the command line.  I know from our test that our program needs a \"net\" and \"read\" permissions. We can grant this using the following command.\n\n~~~shell\ndeno run --allow-net --allow-read webserver_v1.js\n~~~\n\nBetter yet we can compile our JavaScript program into an executable file. The is handy because we can run it without Deno being installed (such as on a different computer using the same operating system and processor). An executable becomes similar to our other tools in our tool box like our terminal application, text editor and web browser.\n\n~~~shell\ndeno compile --allow-net --allow-read webserver_v1.js\n~~~\n\nThis should result in a file being created called \"webserver_v1\" (or on Windows, \"webserver_v1.exe\"). This file can be run from this directory or moved to the directory you store other programs.\n\n## Improving on v1\n\nWhile webserver_v1.js is helpful it could be more friendly. What if I want to use a different port number? What if I want to have the files in my current directory or different directory be where the web content resides?  We can do that by leveraging command line parameters.\n\n~~~JavaScript\n/**\n * webserver_v2.js - A simple static file server with configurable port and root directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\n// Check the command arguments and set the port and rootPath appropriately\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});\n~~~\n\nI can compile that using the following deno compile command\n\n~~~shell\ndeno compile --allow-net --allow-read webserver_v2.js\n~~~\n\nI can run your new webserver using the following command.\n\n~~~shell\n./webserver_v2 8001 .\n~~~\n\nPoint the web browser at <http://localhost:8001>. What do you see? Can you find \"helloworld.html\"? Shutdown the web server and then start it again using just the executable name.\n\nmacOS and Linux\n\n~~~shell\n./webserver_v2\n~~~\n\non Windows\n\n~~~shell\n.\\webserver_v2\n~~~\n\nWhat do you see? Can you find \"helloworld.html\"? Stop the web server. Copy \"helloworld.html\" to \"index.html\". After you copy the file start up the web server again.\n\nOn macOS and Linux\n\n~~~shell\ncp htdocs/helloworld.html htdocs/index.html\n./webserver_v2\n~~~\n\nOn Windows\n\n~~~pwsh\ncopy htdocs\\helloworld.html htdocs\\index.html\n.\\webserver_v2\n~~~\n\nPoint the web browser at <http://localhost:8000>, what do you see?\n\nCan we improve on this?  It'd be nice to web able to just type \"webserver_v2\" and have us the port and htdocs directory of our choice. We can do this using a configuration file. YAML is an easy to read and easy to type notation that expresses the same types of data structures as JSON (JavaScript Object Notation). Here's an example of what a configuration file. Type it in and save it using the filename \"webserver.yaml\".\n\n~~~yaml\n# Set root path for web content to the current directory.\nhtdocs: .\n# Set the port number to listen on to 8002\nport: 8002\n~~~\n\nFrom the point of the view of our program we'll need to see if the \"webserver.yaml\" file exists and Deno has a module for that. We'll also need to read the YAML and parse it. Deno also has a standard model for working with YAML too. The modules we're interested in are `@std/fs/exists` and `@std/yaml`. We'll need to \"add\" them to our deno project first.\n\n~~~shell\ndeno add jsr:@std/fs/exists\ndeno add jsr:@std/yaml\n~~~\n\nNow let's write our improved version of our static web server. It should be called, \"webserver_v3.js\".\n\n~~~JavaScript\n/**\n * webserver_v3.js - A simple static file server with configurable port and root directory via YAML.\n */\nimport { serveDir } from \"@std/http/file-server\";\nimport { parse } from \"@std/yaml/parse\";\nimport { exists } from \"@std/fs/exists\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Function to read and parse YAML configuration file\nasync function readConfigFile(filePath) {\n  try {\n    const fileContent = await Deno.readTextFile(filePath);\n    return parse(fileContent);\n  } catch (err) {\n    console.error(\"Error reading or parsing YAML file:\", err);\n    return null;\n  }\n}\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n} else {\n  // Check for YAML configuration file\n  const configFilePath = \"webserver.yaml\";\n  if (await exists(configFilePath)) {\n    const config = await readConfigFile(configFilePath);\n    if (config) {\n      rootPath = config.htdocs || defaultRoot;\n      port = config.port || defaultPort;\n    }\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});\n~~~\n\nLike before I compile it with the my desired permissions.\n\n~~~shell\ndeno compile --allow-net --allow-read webserver_v3.js\n./webserver_v3\n~~~\n\nPoint the web browser at <http://localhost:8002>. What do you see?  Can you find our HTML files?\n\nI think we have a useful localhost static content web server. It's time to rename our working prototype version and install it so we have it available in our toolbox.\n\n1. Copy `webserver_v3.js` to `webserver.js` \n2. Use `deno compile` to create an executable\n3. Create a \"$HOME/bin\" directory if necessary\n4. Move the executable to a location in your with, example \"$HOME/bin\"\n5. If needed add \"$HOME/bin\" to your path, you can check this to be sure\n\nOn macOS and Linux\n\n~~~shell\ncp webserver_v3.js webserver.js\ndeno compile --allow-net --allow-read webserver.js\nmkdir -p $HOME/bin\nmv ./webserver $HOME/bin\nwebserver\n~~~\n\nOn Windows\n\n~~~shell\ncopy webserver_v3.js webserver.js\ndeno install --global --allow-net --allow-read webserver.js\nNew-Item -ItemType Directory -Path \"$HOME\\bin\" -Force\nmove webserver.exe $HOME\\bin\\\nwebserver\n~~~\n\nIf the \"$HOME/bin\" or \"$HOME\\bin\" are not in your PATH then you'll need to refer to your operating system instruction to add that directory to your path.\n\nThere you have it, a conveint static web server for your own localhost.\n\n",
  "content_ast": {
    "children": [
      {
        "children": [
          {
            "type": "text",
            "value": "Build your own static web server with Deno"
          }
        ],
        "depth": 1,
        "type": "heading"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "One of things I have in my web toolbox is a static site web server. It only runs on localhost. It amazes me how often I wind up using it. PHP and Python can launch one easily from the command line but I have always found they were lacking. What I want is a simple web server that runs only on localhost. It can serve content from a specified directory and should handle common content types appropriately (e.g. JavaScript files are served as \"application/javascript\" not as \"text/plain\"). I should be able choose the port the server runs on. I should be able to specify a document root for the content I want to expose. It should default to a sensible location like the \"htdocs\" directory in my current working directory."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Deno is a JavaScript and TypeScript runtime. I prefer Deno for several reasons over other runtimes like NodeJS. First Deno runs sandboxed similar to the web browser. Deno's standard library follows browser where there is overlap between running on your machien versus the browser. Deno good set  of standard modules. This includes \"@std/http/file-server\" which I'll use to create a static site web server. Other modules I'll be using are \"@std/fs/exists\" and \"@std/yaml/parse\". Normally when I write for Deno I write TypeScript but for this article I'm going to use plain old JavaScript."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Let's build a simple but useful static web server for our web toolbox."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Before we build our static web server some web content, an HTML file. Create a directory \"htdocs\" directory. On macOS, Linux and Windows the command we want to run in the terminal is "
          },
          {
            "type": "inlineCode",
            "value": "mkdir htdocs"
          },
          {
            "type": "text",
            "value": ". Using your text editor, create the HTML file called \"helloworld.html\" inside the \"htdocs\" directory."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "html",
        "type": "code",
        "value": "<!DOCTYPE html>\n<head>\n  <script type=\"module\" src=\"helloworld.js\"></script>\n</head>\n<html lang=\"en-US\">\n  <body>Hello World</body>\n</html>"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Now let's create a \"helloworld.js\" inside the \"htdocs\" directory too."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "const body = document.querySelector(\"body\");\nconst elem = document.createElement(\"div\");\nelem.innerText = 'Hello World 2!';\nbody.append(elem);"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "This will give us some content to test with."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Your directory tree shoud look something like this."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "tree htdocs\nhtdocs/\n├── helloworld.html\n└── helloworld.js\n\n1 directory, 2 files"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I'll use these two files to for tesitng the web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "First take"
          }
        ],
        "depth": 2,
        "type": "heading"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Using a text editor, create a file called "
          },
          {
            "type": "inlineCode",
            "value": "webserver_v1.js"
          },
          {
            "type": "text",
            "value": ". We need to do several things in JavaScript to build our static web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "import a function called "
                  },
                  {
                    "type": "inlineCode",
                    "value": "serveDir"
                  },
                  {
                    "type": "text",
                    "value": " from the \"@std/http/file-server\" module"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "We need to set two constants, our port number and root document path"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "It is helpful to display the setting for the port and document root"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "We can using Deno's built in "
                  },
                  {
                    "type": "inlineCode",
                    "value": "serve"
                  },
                  {
                    "type": "text",
                    "value": " method to handle inbound requests and then dispatch them to "
                  },
                  {
                    "type": "inlineCode",
                    "value": "serveDir"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          }
        ],
        "ordered": true,
        "spread": false,
        "start": 1,
        "type": "list"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Let's start with our import, "
          },
          {
            "type": "inlineCode",
            "value": "\"@std/http/file-server"
          },
          {
            "type": "text",
            "value": ".  Notice that it starts with and \"@\". This indicates to the JavaScript runtime that the full URL to the module is found in a import map. When you build a Deno project you can use a file called "
          },
          {
            "type": "inlineCode",
            "value": "deno.json"
          },
          {
            "type": "text",
            "value": " to include a mapping of module names. The "
          },
          {
            "type": "inlineCode",
            "value": "deno"
          },
          {
            "type": "text",
            "value": " command provides a really easy way to manage this mapping. As of Deno 2 the standard modules are available from "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "jsr.io"
              }
            ],
            "type": "link",
            "url": "https://jsr.io"
          },
          {
            "type": "text",
            "value": ", a JavaScript registry. The module "
          },
          {
            "type": "inlineCode",
            "value": "@std/http/file-server"
          },
          {
            "type": "text",
            "value": " is part of the standard module package called "
          },
          {
            "type": "inlineCode",
            "value": "@std/http"
          },
          {
            "type": "text",
            "value": ". We can \"add\" that to our project using the following command"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno add jsr:@std/http"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "If the \"deno.json\" file does not exist this command will create it. If you look inside it after running this command you'll see something like this."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "json",
        "type": "code",
        "value": "{\n  \"imports\": {\n    \"@std/http\": \"jsr:@std/http@^1.0.18\"\n  }\n}"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "The Deno run time knows how to contact jsr.io and use it to etrieve the module requested.  By default it picks the current stable version. In our case that is currently v1.0.18. If you are reading this is in the distant the future is the version number will likely have changed. Deno updates have come pretty steadly in 2025."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Now that that Deno is setup, I need to write our first version of a static web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "/**\n * webserver_v1.js - A simple static file server for serving files from the \"htdocs\" directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst port = 8000;\nconst rootPath = \"htdocs\"; // Serve files from the \"htdocs\" directory\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Let's see if the code we typed in works. Deno provide two helpful commands."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "check"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "lint"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          }
        ],
        "ordered": true,
        "spread": false,
        "start": 1,
        "type": "list"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Check read the JavaScript (or TypeScript) file and makes server it makes sense from the compilation point of view.  The lint command goes a step further. It checks to see if best practices have been followed. Lint is completely optional but check needs to pass before Deno will attempt to run our program."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno check webserver_v1.js\ndeno lint webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "If all went well in both cases you should see a line indicating it checked the file. If there are complaints you'll see those too."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Deno can run in interactive mode. To test our program we'll initially run it."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno run webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "You should a message like the one below. This is because Deno wants permission to access the network."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "Server running on http://localhost:8000/, serving htdocs\n┏ ⚠️  Deno requests net access to \"0.0.0.0:8000\".\n┠─ Requested by `Deno.listen()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-net\n┠─ Run again with --allow-net to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all net permissions) > "
      },
      {
        "children": [
          {
            "type": "text",
            "value": "For can type an \"y\" for now. Now you should see a lines like those below."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "Server running on http://localhost:8000/, serving htdocs\n✅ Granted net access to \"0.0.0.0:8000\".\nListening on http://0.0.0.0:8000/ (http://localhost:8000/)"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Point your web browser to \"http://localhost:8000/\". Do you see anything?  In your terminal window you'll see another prompt about permissions."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "┏ ⚠️  Deno requests read access to \"htdocs\".\n┠─ Requested by `Deno.stat()` API.\n┠─ To see a stack trace for this prompt, set the DENO_TRACE_PERMISSIONS environmental variable.\n┠─ Learn more at: https://docs.deno.com/go/--allow-read\n┠─ Run again with --allow-read to bypass this prompt.\n┗ Allow? [y/n/A] (y = yes, allow; n = no, deny; A = allow all read permissions)"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Again answer \"y\". You then see something like this in the terminal window."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "[2025-06-30 16:27:31] [GET] / 200\nNo such file or directory (os error 2): stat '/Users/rsdoiel/Sandbox/Writing/Books/A_Simple_Web/htdocs/favicon.ico'\n[2025-06-30 16:27:31] [GET] /favicon.ico 404"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "What do you do you see in the browser page?  Is it a list of files? Is one of them \"helloworld.html\"?  If so click on it. You should now see an simple web page with the words \"Hello World\". Congratulations, you've created your first static web server."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "You might be wondering how to shutdown the web server. In the terminal window press control and the letter c, aka \"Ctrl-C\". This will shutdown the web server. You can confirm it is shutdown in the web browser by reloading the page."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "You don't need to answer questions about permissions each time you run a program. You can specify the permissions you want to grant on the command line.  I know from our test that our program needs a \"net\" and \"read\" permissions. We can grant this using the following command."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno run --allow-net --allow-read webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Better yet we can compile our JavaScript program into an executable file. The is handy because we can run it without Deno being installed (such as on a different computer using the same operating system and processor). An executable becomes similar to our other tools in our tool box like our terminal application, text editor and web browser."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno compile --allow-net --allow-read webserver_v1.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "This should result in a file being created called \"webserver_v1\" (or on Windows, \"webserver_v1.exe\"). This file can be run from this directory or moved to the directory you store other programs."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Improving on v1"
          }
        ],
        "depth": 2,
        "type": "heading"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "While webserver_v1.js is helpful it could be more friendly. What if I want to use a different port number? What if I want to have the files in my current directory or different directory be where the web content resides?  We can do that by leveraging command line parameters."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "/**\n * webserver_v2.js - A simple static file server with configurable port and root directory.\n */\nimport { serveDir } from \"@std/http/file-server\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\n// Check the command arguments and set the port and rootPath appropriately\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I can compile that using the following deno compile command"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno compile --allow-net --allow-read webserver_v2.js"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I can run your new webserver using the following command."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "./webserver_v2 8001 ."
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Point the web browser at "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "http://localhost:8001"
              }
            ],
            "type": "link",
            "url": "http://localhost:8001"
          },
          {
            "type": "text",
            "value": ". What do you see? Can you find \"helloworld.html\"? Shutdown the web server and then start it again using just the executable name."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "macOS and Linux"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "./webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "on Windows"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": ".\\webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "What do you see? Can you find \"helloworld.html\"? Stop the web server. Copy \"helloworld.html\" to \"index.html\". After you copy the file start up the web server again."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On macOS and Linux"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "cp htdocs/helloworld.html htdocs/index.html\n./webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On Windows"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "pwsh",
        "type": "code",
        "value": "copy htdocs\\helloworld.html htdocs\\index.html\n.\\webserver_v2"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Point the web browser at "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "http://localhost:8000"
              }
            ],
            "type": "link",
            "url": "http://localhost:8000"
          },
          {
            "type": "text",
            "value": ", what do you see?"
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Can we improve on this?  It'd be nice to web able to just type \"webserver_v2\" and have us the port and htdocs directory of our choice. We can do this using a configuration file. YAML is an easy to read and easy to type notation that expresses the same types of data structures as JSON (JavaScript Object Notation). Here's an example of what a configuration file. Type it in and save it using the filename \"webserver.yaml\"."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "yaml",
        "type": "code",
        "value": "# Set root path for web content to the current directory.\nhtdocs: .\n# Set the port number to listen on to 8002\nport: 8002"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "From the point of the view of our program we'll need to see if the \"webserver.yaml\" file exists and Deno has a module for that. We'll also need to read the YAML and parse it. Deno also has a standard model for working with YAML too. The modules we're interested in are "
          },
          {
            "type": "inlineCode",
            "value": "@std/fs/exists"
          },
          {
            "type": "text",
            "value": " and "
          },
          {
            "type": "inlineCode",
            "value": "@std/yaml"
          },
          {
            "type": "text",
            "value": ". We'll need to \"add\" them to our deno project first."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno add jsr:@std/fs/exists\ndeno add jsr:@std/yaml"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Now let's write our improved version of our static web server. It should be called, \"webserver_v3.js\"."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "JavaScript",
        "type": "code",
        "value": "/**\n * webserver_v3.js - A simple static file server with configurable port and root directory via YAML.\n */\nimport { serveDir } from \"@std/http/file-server\";\nimport { parse } from \"@std/yaml/parse\";\nimport { exists } from \"@std/fs/exists\";\n\nconst defaultPort = 8000;\nconst defaultRoot = \"htdocs\";\n\n// Function to read and parse YAML configuration file\nasync function readConfigFile(filePath) {\n  try {\n    const fileContent = await Deno.readTextFile(filePath);\n    return parse(fileContent);\n  } catch (err) {\n    console.error(\"Error reading or parsing YAML file:\", err);\n    return null;\n  }\n}\n\n// Parse command-line arguments\nconst args = Deno.args;\nlet rootPath = defaultRoot;\nlet port = defaultPort;\n\nif (args.length > 0) {\n  // Check if the first argument is a port number\n  const portArg = parseInt(args[0], 10);\n  if (!isNaN(portArg)) {\n    port = portArg;\n  } else {\n    // If not a port number, assume it's the root path\n    rootPath = args[0];\n  }\n\n  // Check if the second argument is a root path\n  if (args.length > 1) {\n    rootPath = args[1];\n  }\n} else {\n  // Check for YAML configuration file\n  const configFilePath = \"webserver.yaml\";\n  if (await exists(configFilePath)) {\n    const config = await readConfigFile(configFilePath);\n    if (config) {\n      rootPath = config.htdocs || defaultRoot;\n      port = config.port || defaultPort;\n    }\n  }\n}\n\nconsole.log(`Server running on http://localhost:${port}/, serving ${rootPath}`);\n\n// Start a simple server\nDeno.serve({\n  port,\n}, async (req) => {\n  try {\n    // Serve files from the specified directory\n    return await serveDir(req, {\n      fsRoot: rootPath,\n      urlRoot: \"\",\n      showDirListing: true,\n      showDotfiles: false, // Exclude files starting with a period\n    });\n  } catch (err) {\n    console.error(err);\n    // Return a 404 response if something goes wrong\n    return new Response(\"404: Not Found\", { status: 404 });\n  }\n});"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Like before I compile it with the my desired permissions."
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "deno compile --allow-net --allow-read webserver_v3.js\n./webserver_v3"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "Point the web browser at "
          },
          {
            "children": [
              {
                "type": "text",
                "value": "http://localhost:8002"
              }
            ],
            "type": "link",
            "url": "http://localhost:8002"
          },
          {
            "type": "text",
            "value": ". What do you see?  Can you find our HTML files?"
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "I think we have a useful localhost static content web server. It's time to rename our working prototype version and install it so we have it available in our toolbox."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Copy "
                  },
                  {
                    "type": "inlineCode",
                    "value": "webserver_v3.js"
                  },
                  {
                    "type": "text",
                    "value": " to "
                  },
                  {
                    "type": "inlineCode",
                    "value": "webserver.js"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Use "
                  },
                  {
                    "type": "inlineCode",
                    "value": "deno compile"
                  },
                  {
                    "type": "text",
                    "value": " to create an executable"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Create a \"$HOME/bin\" directory if necessary"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "Move the executable to a location in your with, example \"$HOME/bin\""
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          },
          {
            "children": [
              {
                "children": [
                  {
                    "type": "text",
                    "value": "If needed add \"$HOME/bin\" to your path, you can check this to be sure"
                  }
                ],
                "type": "paragraph"
              }
            ],
            "spread": false,
            "type": "listItem"
          }
        ],
        "ordered": true,
        "spread": false,
        "start": 1,
        "type": "list"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On macOS and Linux"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "cp webserver_v3.js webserver.js\ndeno compile --allow-net --allow-read webserver.js\nmkdir -p $HOME/bin\nmv ./webserver $HOME/bin\nwebserver"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "On Windows"
          }
        ],
        "type": "paragraph"
      },
      {
        "lang": "shell",
        "type": "code",
        "value": "copy webserver_v3.js webserver.js\ndeno install --global --allow-net --allow-read webserver.js\nNew-Item -ItemType Directory -Path \"$HOME\\bin\" -Force\nmove webserver.exe $HOME\\bin\\\nwebserver"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "If the \"$HOME/bin\" or \"$HOME\\bin\" are not in your PATH then you'll need to refer to your operating system instruction to add that directory to your path."
          }
        ],
        "type": "paragraph"
      },
      {
        "children": [
          {
            "type": "text",
            "value": "There you have it, a conveint static web server for your own localhost."
          }
        ],
        "type": "paragraph"
      }
    ],
    "type": "root"
  },
  "data": {
    "abstract": "This chapter demonstrates how to build a static web server using Deno.\n",
    "author": "R. S. Doiel",
    "byline": "R. S. Doiel",
    "copyright": "copyright (c) 2025, R. S. Doiel",
    "dateCreated": "2025-06-30",
    "dateModified": "2025-06-30",
    "keywords": [
      "web service",
      "static web site"
    ],
    "license": "https://creativecommons.org/licenses/by-sa/4.0/",
    "number": 8,
    "pubDate": "2025-06-30",
    "series": "Deno and TypeScript",
    "title": "Build a Static Web Server with Deno"
  }
}