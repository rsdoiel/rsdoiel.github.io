<!doctype html>
<html lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="antenna/0.0.10" />
  <meta name="date" content="2025-10-03T16:58:06-07:00" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="language" content="EN" />
  <title>R. S. Doiel, Software Engineer/Analyst &mdash; Robert's ramblings</title>
  <link rel="altenate" type="text/markdown" title="R. S. Doiel, Software Engineer/Analyst &mdash; Robert's ramblings" href="FreeDOS-1.3rc4-with-Qemu.md" />
  <link type="text/css" href="/css/site.css" rel="stylesheet" />
  <link rel="alternate" title="Recent Blog Post" type="application/rss+xml" href="index.xml" />
  <link rel="alternate" title="Archive of Blog Posts" type="application/rss+xml" href="archive.xml" />
  <link rel="alternate" title="Markdown source for page" type="application/markdown" href="index.md" />
  <link rel="search" type="application/opensearchdescription+xml" title="Robert's Rambling Search Engine" href="osd.xml" />
</head>
<body>
  <nav>
    <ul>
    <li><a href="/" title="R. S. Doiel"><img class="blog-logo" src="/media/Wee-Free-Doiels-Summer-Reading.svg" alt="Wee Free Doiels, Summer Reading"></a></li>
    <li><a href="/">R. S. Doiel</a></li>
    <li><a href="/about.html">About</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/presentations.html">Presentations</a></li>
    <li><a href="/series/">Series</a></li>
    <li><a href="/search.html">Search</a></li>
    <li><a href="https://github.com/rsdoiel">GitHub</a></li>
    <li><a href="/rss.xml" title="RSS Feed">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9"></path>
    <path d="M4 4a16 16 0 0 1 16 16"></path>
    <circle cx="5" cy="19" r="1"></circle> </svg> RSS </a></li>
    </ul>
  </nav>

  <section>
    <article data-published="2021-11-27" data-link="https://rsdoiel.github.io/blog/2021/11/27/FreeDOS-1.3rc4-with-Qemu.html">
      <h2>Setting up FreeDOS 1.3rc4 with Qemu</h2>
      <p>By R. S. Doiel, 2021-11-27</p>
      <p>In this article I'm going explore setting up FreeDOS with Qemu
      on my venerable Dell 4319 running Raspberry Pi Desktop OS (Debian
      GNU/Linux).  First step is to download FreeDOS &quot;Live CD&quot; in the
      1.3 RC4 release. See <a href="http://freedos.org/download/">http://freedos.org/download/</a> for that.</p>
      <h2>Installing Qemu</h2>
      <p>I needed to install Qemu in my laptop. It runs the Raspberry Pi
      Desktop OS (i.e. Debian with Raspberry Pi UI). I choose to install
      the &quot;qemu-system&quot; package since I will likely use qemu for other
      things besides FreeDOS. The qemu-system package contains all the
      various systems I might want to emulate in other projects as well
      as several qemu utilities that are handy.  Here's the full sequence
      of <code>apt</code> commands I ran (NOTE: these included making sure my laptop
      was up to date before I installed qemu-system).</p>
      <pre><code>sudo apt update
      sudo apt upgrade
      sudo apt install qemu-system
      </code></pre>
      <p>Now that I had the software available it was time to figure out
      how to actually knit things together and run FreeDOS.</p>
      <h2>Obtaining FreeDOS 1.3rc4</h2>
      <p>Before I get started I create a folder in my home directory
      for running everything. You can name it what you want
      but I called mine <code>FreeDOS_13</code> and changed into that folder
      for the work in this article.</p>
      <pre><code>mkdir FreeDOS_13
      cd FreeDOS_13
      </code></pre>
      <p>I initially tried the CD images but ran into odd problems with
      qemu (possibly due to my lack of experience with qemu).
      After looking at that various options the USB Full release
      seemed like a good choice. It comes both as an image you can
      &quot;burn&quot; to your USB drive both also as a &quot;vmdk&quot; file used with
      emulators.</p>
      <pre><code>curl -L -O https://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.3/previews/1.3-rc4/FD13-FullUSB.zip
      unzip FD13-FullUSB.zip
      </code></pre>
      <p>At this point you should see the FreeDOS &quot;vmdk&quot; file, and &quot;img&quot; file and readme files if you list the directory out. I'm going to use the &quot;vmdk&quot; file to install FreeDOS on my virtual harddrive freedos.img.</p>
      <pre><code>ls -l 
      </code></pre>
      <h2>Prepping my virtual machine</h2>
      <p>A virtual machine is not just a CPU and some random
      access memory. A machine can include storage devices. For
      the retro &quot;DOS&quot; experience you might looking virtual devices
      for a &quot;harddrive&quot;, &quot;floppy drive&quot; and &quot;CD-ROM drive&quot;.
      Qemu provides a tool called <code>qemu-img</code> for creating
      these types of virtual devices.</p>
      <p>The basic command is <code>qemu-img</code> using the &quot;create&quot; option with
      some parameters.  The parameter are filename and size (see<code>man qemu-img</code> for gory details). I am calling my virtual
      harddrive &quot;freedos.img&quot;.  With <code>qemu-img</code> the size can be
      specified with a suffix like &quot;K&quot; for kilobytes,  &quot;M&quot; for
      megabytes and &quot;G&quot; for gigabytes. DOS is a minimal requirements
      a small (by today's standards) 750 megabyte harddrive seems
      appropriate.</p>
      <pre><code>qemu-img create freedos.img 750M
      </code></pre>
      <p>For my purposes I need a harddrive so I stopped there. You
      can always create other drives and then restart your virtual
      machine with the appropriate options.</p>
      <h2>Bring up my FreeDOS box</h2>
      <p>Now I was ready to boot from installation media and install
      FreeDOS 1.3rc4 on my virtual harddrive.  For that I
      use a &quot;qemu&quot; command for the system I want to emulate.
      I picked <code>qemu-system-i386</code> (see can see
      the gory details of that command using <code>man qemu-system-i386</code>).
      To install FreeDOS I'm going to boot from the vmdk file
      provided for the purpose of installation. I then use the FreeDOS
      installer to make my freedos.img file bootable with all the
      DOS software I want to play with.</p>
      <pre><code>qemu-system-i386 \
         -m 8 \
         -boot menu=on,strict=on \
         -hda freedos.img \
         -hdb FD13FULL.vmdk
      </code></pre>
      <p>At this point you should see the machine start to boot, press Esc
      when prompted and select the second hard drive to boot from (that's
      our vmdk drive).  The drive is then treated like the CD-ROM, follow
      the programs instructions for installation. You will need to reboot
      several times during the process. Until your full installation is
      complete you'll need to select the second harddrive as the boot drive
      and continue the installation.</p>
      <p>The first time I successfully installed FreeDOS 1.3rc4 I just installed
      the plain dos. When I re-did the process I install everything. It
      fills up my 750M virtual harddrive but rc4 includes development tools
      like a C compiler.  That I think made it worth it.</p>
      <p>Here's a Bash script you can use to build your FreeDOS machine.</p>
      <pre><code>#!/bin/bash
      
      if [ ! -f freedos.img ]; then
        echo &quot;Creating fresh Harddisk as drive C:&quot;
        qemu-img create freedos.img 750M
      fi
      echo &quot;Booting machine using FD13FULL.vmdk for installation&quot;
      qemu-system-i386 \
          -m 8 \
          -boot menu=on,strict=on \
          -hda freedos.img \
          -hdb FD13FULL.vmdk
      </code></pre>
      <p>And here is one for running it.</p>
      <pre><code>#!/bin/bash
      
      echo &quot;Booting machine using freedos.img as drive C:&quot;
      qemu-system-i386 \
          -m 8 \
          -boot menu=on,strict=on \
          -hda freedos.img
      </code></pre>
      <p>Next step, explore FreeDOS and see what I can build.</p>
      <h2>Putting everything together</h2>
      <p>Below is a <a href="run-freedos-1.3rc4.bash">script</a> I developed automating either building or running your FreeDOS setup.</p>
      <pre><code>#!/bin/bash
      
      if [ ! -f FD13FULL.vmdk ]; then
          if [ ! -f FD13-FullUSB.zip ]; then
            echo &quot;Missing FD13FULL.vmdk, downloading FD13-FullUSB.zip&quot;
            curl -L -O https://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.3/previews/1.3-rc4/FD13-FullUSB.zip
          fi
          echo &quot;Unzipping FD13-FullUSB.zip&quot;
          unzip FD13-FullUSB.zip
      fi
      
      if [ ! -f freedos.img ]; then
        echo &quot;Creating fresh Harddisk as drive C:&quot;
        qemu-img create freedos.img 750M
        echo &quot;Booting machine using FD13FULL.vmdk as drive C:&quot;
        echo &quot;Installing FreeDOS on drive D:&quot;
        qemu-system-i386 \
            -name FreeDOS \
            -machine pc \
            -m 32 \
            -boot order=c \
            -hda FD13FULL.vmdk \
            -hdb freedos.img \
            -parallel none \
            -vga cirrus \
            -display gtk
      else
        echo &quot;Booting machine using freedos.img on drive C:&quot;
        qemu-system-i386 \
            -name FreeDOS \
            -machine pc \
            -m 32 \
            -boot menu=on,strict=on \
            -hda freedos.img \
            -parallel none \
            -vga cirrus \
            -display gtk
      fi
      </code></pre>
      <h2>Reference material</h2>
      <p>My inspiration for this was the description of manual install in
      the FreeDOS book section of the website, <a href="https://www.freedos.org/books/get-started/june14-manual-install.html">Manual Install</a>.</p>
      
    </article>
  </section>
  <footer>
    <footer>
    <p>copyright © 2016 - 2025 R. S. Doiel<br /> <a
    href="/rssfeed.html">RSS</a> feeds and website built with <a
    href="https://rsdoiel.github.io/antennaApp">antennaApp</a>.
    </footer>
    <script type="module">
      await import('/pagefind/pagefind-highlight.js');
      new PagefindHighlight({ highlightParam: "highlight" });
    </script>
  </footer>
</body>
</html>
