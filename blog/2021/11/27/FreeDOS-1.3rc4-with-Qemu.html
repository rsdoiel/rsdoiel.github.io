<!doctype html>
<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <link  rel="alternate" type="text/markdown" href="FreeDOS-1.3rc4-with-Qemu.md" title=""/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/css/site.css" />
  <meta name="generator" content="antenna/0.0.6">
  <meta name="date" content="2025-09-15T14:10:21-07:00">
</head>
<body>
  <header>
    (date: 2025-09-15 14:10:21)
  </header>
  <nav>
    <ul>
    <li><a href="/" title="R. S. Doiel"><img class="blog-logo" src="/media/Wee-Free-Doiels-Summer-Reading.svg" alt="Wee Free Doiels, Summer Reading"></a></li>
    <li><a href="/">R. S. Doiel</a></li>
    <li><a href="/about.html">About</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/presentations.html">Presentations</a></li>
    <li><a href="/series/">Series</a></li>
    <li><a href="/search.html">Search</a></li>
    <li><a href="https://github.com/rsdoiel">GitHub</a></li>
    <li><a href="/index.xml" title="RSS, recent posts">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9"></path>
    <path d="M4 4a16 16 0 0 1 16 16"></path>
    <circle cx="5" cy="19" r="1"></circle> </svg> RSS </a></li>
    </ul>
  </nav>

  <section>
    <article data-published="2021-11-27" data-link="https://rsdoiel.github.io/blog/2021/11/27/FreeDOS-1.3rc4-with-Qemu.html">
      <h2 id="setting-up-freedos-13rc4-with-qemu">Setting up FreeDOS 1.3rc4 with Qemu</h2>
      <p>By R. S. Doiel, 2021-11-27</p>
      <p>In this article I'm going explore setting up FreeDOS with Qemu<br />
      on my venerable Dell 4319 running Raspberry Pi Desktop OS (Debian<br />
      GNU/Linux).  First step is to download FreeDOS &quot;Live CD&quot; in the<br />
      1.3 RC4 release. See <a href="http://freedos.org/download/">http://freedos.org/download/</a> for that.</p>
      <h2 id="installing-qemu">Installing Qemu</h2>
      <p>I needed to install Qemu in my laptop. It runs the Raspberry Pi<br />
      Desktop OS (i.e. Debian with Raspberry Pi UI). I choose to install<br />
      the &quot;qemu-system&quot; package since I will likely use qemu for other<br />
      things besides FreeDOS. The qemu-system package contains all the<br />
      various systems I might want to emulate in other projects as well<br />
      as several qemu utilities that are handy.  Here's the full sequence<br />
      of <code>apt</code> commands I ran (NOTE: these included making sure my laptop<br />
      was up to date before I installed qemu-system).</p>
      <pre><code>sudo apt update
      sudo apt upgrade
      sudo apt install qemu-system
      </code></pre>
      <p>Now that I had the software available it was time to figure out<br />
      how to actually knit things together and run FreeDOS.</p>
      <h2 id="obtaining-freedos-13rc4">Obtaining FreeDOS 1.3rc4</h2>
      <p>Before I get started I create a folder in my home directory<br />
      for running everything. You can name it what you want<br />
      but I called mine <code>FreeDOS_13</code> and changed into that folder<br />
      for the work in this article.</p>
      <pre><code>mkdir FreeDOS_13
      cd FreeDOS_13
      </code></pre>
      <p>I initially tried the CD images but ran into odd problems with<br />
      qemu (possibly due to my lack of experience with qemu).<br />
      After looking at that various options the USB Full release<br />
      seemed like a good choice. It comes both as an image you can<br />
      &quot;burn&quot; to your USB drive both also as a &quot;vmdk&quot; file used with<br />
      emulators.</p>
      <pre><code>curl -L -O https://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.3/previews/1.3-rc4/FD13-FullUSB.zip
      unzip FD13-FullUSB.zip
      </code></pre>
      <p>At this point you should see the FreeDOS &quot;vmdk&quot; file, and &quot;img&quot; file and readme files if you list the directory out. I'm going to use the &quot;vmdk&quot; file to install FreeDOS on my virtual harddrive freedos.img.</p>
      <pre><code>ls -l 
      </code></pre>
      <h2 id="prepping-my-virtual-machine">Prepping my virtual machine</h2>
      <p>A virtual machine is not just a CPU and some random<br />
      access memory. A machine can include storage devices. For<br />
      the retro &quot;DOS&quot; experience you might looking virtual devices<br />
      for a &quot;harddrive&quot;, &quot;floppy drive&quot; and &quot;CD-ROM drive&quot;.<br />
      Qemu provides a tool called <code>qemu-img</code> for creating<br />
      these types of virtual devices.</p>
      <p>The basic command is <code>qemu-img</code> using the &quot;create&quot; option with<br />
      some parameters.  The parameter are filename and size (see<br />
      <code>man qemu-img</code> for gory details). I am calling my virtual<br />
      harddrive &quot;freedos.img&quot;.  With <code>qemu-img</code> the size can be<br />
      specified with a suffix like &quot;K&quot; for kilobytes,  &quot;M&quot; for<br />
      megabytes and &quot;G&quot; for gigabytes. DOS is a minimal requirements<br />
      a small (by today's standards) 750 megabyte harddrive seems<br />
      appropriate.</p>
      <pre><code>qemu-img create freedos.img 750M
      </code></pre>
      <p>For my purposes I need a harddrive so I stopped there. You<br />
      can always create other drives and then restart your virtual<br />
      machine with the appropriate options.</p>
      <h2 id="bring-up-my-freedos-box">Bring up my FreeDOS box</h2>
      <p>Now I was ready to boot from installation media and install<br />
      FreeDOS 1.3rc4 on my virtual harddrive.  For that I<br />
      use a &quot;qemu&quot; command for the system I want to emulate.<br />
      I picked <code>qemu-system-i386</code> (see can see<br />
      the gory details of that command using <code>man qemu-system-i386</code>).<br />
      To install FreeDOS I'm going to boot from the vmdk file<br />
      provided for the purpose of installation. I then use the FreeDOS<br />
      installer to make my freedos.img file bootable with all the<br />
      DOS software I want to play with.</p>
      <pre><code>qemu-system-i386 \
         -m 8 \
         -boot menu=on,strict=on \
         -hda freedos.img \
         -hdb FD13FULL.vmdk
      </code></pre>
      <p>At this point you should see the machine start to boot, press Esc<br />
      when prompted and select the second hard drive to boot from (that's<br />
      our vmdk drive).  The drive is then treated like the CD-ROM, follow<br />
      the programs instructions for installation. You will need to reboot<br />
      several times during the process. Until your full installation is<br />
      complete you'll need to select the second harddrive as the boot drive<br />
      and continue the installation.</p>
      <p>The first time I successfully installed FreeDOS 1.3rc4 I just installed<br />
      the plain dos. When I re-did the process I install everything. It<br />
      fills up my 750M virtual harddrive but rc4 includes development tools<br />
      like a C compiler.  That I think made it worth it.</p>
      <p>Here's a Bash script you can use to build your FreeDOS machine.</p>
      <pre><code>#!/bin/bash
      
      if [ ! -f freedos.img ]; then
        echo &quot;Creating fresh Harddisk as drive C:&quot;
        qemu-img create freedos.img 750M
      fi
      echo &quot;Booting machine using FD13FULL.vmdk for installation&quot;
      qemu-system-i386 \
          -m 8 \
          -boot menu=on,strict=on \
          -hda freedos.img \
          -hdb FD13FULL.vmdk
      </code></pre>
      <p>And here is one for running it.</p>
      <pre><code>#!/bin/bash
      
      echo &quot;Booting machine using freedos.img as drive C:&quot;
      qemu-system-i386 \
          -m 8 \
          -boot menu=on,strict=on \
          -hda freedos.img
      </code></pre>
      <p>Next step, explore FreeDOS and see what I can build.</p>
      <h2 id="putting-everything-together">Putting everything together</h2>
      <p>Below is a <a href="run-freedos-1.3rc4.bash">script</a> I developed automating either building or running your FreeDOS setup.</p>
      <pre><code>#!/bin/bash
      
      if [ ! -f FD13FULL.vmdk ]; then
          if [ ! -f FD13-FullUSB.zip ]; then
            echo &quot;Missing FD13FULL.vmdk, downloading FD13-FullUSB.zip&quot;
            curl -L -O https://www.ibiblio.org/pub/micro/pc-stuff/freedos/files/distributions/1.3/previews/1.3-rc4/FD13-FullUSB.zip
          fi
          echo &quot;Unzipping FD13-FullUSB.zip&quot;
          unzip FD13-FullUSB.zip
      fi
      
      if [ ! -f freedos.img ]; then
        echo &quot;Creating fresh Harddisk as drive C:&quot;
        qemu-img create freedos.img 750M
        echo &quot;Booting machine using FD13FULL.vmdk as drive C:&quot;
        echo &quot;Installing FreeDOS on drive D:&quot;
        qemu-system-i386 \
            -name FreeDOS \
            -machine pc \
            -m 32 \
            -boot order=c \
            -hda FD13FULL.vmdk \
            -hdb freedos.img \
            -parallel none \
            -vga cirrus \
            -display gtk
      else
        echo &quot;Booting machine using freedos.img on drive C:&quot;
        qemu-system-i386 \
            -name FreeDOS \
            -machine pc \
            -m 32 \
            -boot menu=on,strict=on \
            -hda freedos.img \
            -parallel none \
            -vga cirrus \
            -display gtk
      fi
      </code></pre>
      <h2 id="reference-material">Reference material</h2>
      <p>My inspiration for this was the description of manual install in<br />
      the FreeDOS book section of the website, <a href="https://www.freedos.org/books/get-started/june14-manual-install.html">Manual Install</a>.</p>
      
    </article>
  </section>
  <footer>
    <p>copyright © 2016 - 2025 R. S. Doiel<br /> <a
    href="/rssfeed.html">RSS</a> feeds and website built with <a
    href="https://rsdoiel.github.io/antennaApp">antennaApp</a>, Bash, Make and <a
    href="https://pandoc.org">Pandoc</a>.</p>
  </footer>

    <script type="module" src="/modules/copyToClipboard.js"></script>
    <script type="module">
      await import('/pagefind/pagefind-highlight.js');
      new PagefindHighlight({ highlightParam: "highlight" });
    </script>
</body>
</html>
