<!doctype html>
<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <link  rel="alternate" type="text/markdown" href="Go-and-MySQL-Timestamps.md" title=""/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/css/site.css" />
  <meta name="generator" content="antenna/0.0.6">
  <meta name="date" content="2025-09-15T14:13:10-07:00">
</head>
<body>
  <header>
    (date: 2025-09-15 14:13:10)
  </header>
  <nav>
    <ul>
    <li><a href="/" title="R. S. Doiel"><img class="blog-logo" src="/media/Wee-Free-Doiels-Summer-Reading.svg" alt="Wee Free Doiels, Summer Reading"></a></li>
    <li><a href="/">R. S. Doiel</a></li>
    <li><a href="/about.html">About</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/presentations.html">Presentations</a></li>
    <li><a href="/series/">Series</a></li>
    <li><a href="/search.html">Search</a></li>
    <li><a href="https://github.com/rsdoiel">GitHub</a></li>
    <li><a href="/index.xml" title="RSS, recent posts">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9"></path>
    <path d="M4 4a16 16 0 0 1 16 16"></path>
    <circle cx="5" cy="19" r="1"></circle> </svg> RSS </a></li>
    </ul>
  </nav>

  <section>
    <article data-published="2022-12-12" data-link="https://rsdoiel.github.io/blog/2022/12/12/Go-and-MySQL-Timestamps.html">
      <h1 id="go-and-mysql-timestamps">Go and MySQL timestamps</h1>
      <p>By R. S. Doiel, 2022-12-12</p>
      <p>The Go <a href="https://pkg.go.dev/database/sql">sql</a> package provides a nice abstraction for working with SQL databases. The underlying drivers and DBMS can present some quirks that are SQL dialect and driver specific such as the <a href="github.com/go-sql-driver/mysql">MySQL driver</a>.  Sometimes that is not a big deal. <a href="https://dev.mysql.com">MySQL</a> can maintain a creation timestamp as well as a modified timestamp easily via the SQL schema definition for the field. Unfortunately if you need to work with the MySQL timestamp at a Go level (e.g. display the timestamp in a useful way) the int64 provided via the driver isn't compatible with the <code>int64</code> used in Go's <code>time.Time</code>. To work around this limitation I've found it necessary to convert the MySQL timestamp to a formatted string using <a href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_date-format" title="DATE_FORMAT is a MySQL date/time function returning a string value">DATE_FORMAT</a> and from the Go side convert the formatted string into a <code>time.Time</code> using <code>time.Parse()</code>. Below is some Golang pseudo code showing this approach.</p>
      <pre><code>// Format used by MySQL strings representing date/times
      const MySQLTimestamp = &quot;2006-01-02 15:04:05&quot;
      
      // GetRecordUpdate takes a configuration with a db attribute previously
      // opened and an id string returning a record populated with id and updated values where updated is an attribute of type time.Time. We use MySQL's
      // `DATE_FORMAT()` function to convert the timestamp into a string and
      // Go's `time.Parse()` to convert the string into a `time.Time` value.
      func GetRecordUpdate(cfg, id string) {
      	stmt := `SELECT id, DATE_FORMAT(updated, &quot;%Y-%m-%d %H:%i:%s&quot;) FROM some_tabl WHERE id = ?`
      	row, err := cfg.db.Query(stmt, id)
      	if err != nil {
      		return nil, err
      	}
      	defer row.Close()
      	record := new(Record)
      	if row.Next() {
      		var updated string
      		if err := row.Scan(&amp;record.ID, &amp;updated); err != nil {
      			return nil, err
      		}
      		record.Updated, err = time.Parse(MySQLTimestamp, updated)
      		if err != nil {
      			return nil, err
      		}
      	}
      	err = row.Err()
      	return record, err
      }
      </code></pre>
      
    </article>
  </section>
  <footer>
    <p>copyright Â© 2016 - 2025 R. S. Doiel<br /> <a
    href="/rssfeed.html">RSS</a> feeds and website built with <a
    href="https://rsdoiel.github.io/antennaApp">antennaApp</a>, Bash, Make and <a
    href="https://pandoc.org">Pandoc</a>.</p>
  </footer>

    <script type="module" src="/modules/copyToClipboard.js"></script>
    <script type="module">
      await import('/pagefind/pagefind-highlight.js');
      new PagefindHighlight({ highlightParam: "highlight" });
    </script>
</body>
</html>
